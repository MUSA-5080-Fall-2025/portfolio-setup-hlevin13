"0","# Your spatial analysis"
"0",""
"0","# Set CRS"
"0","schools <- st_transform(schools, crs = 3365)"
"0","crime <- st_transform(crime, crs = 3365)"
"0",""
"0","# Create 1000ft buffers around each school to represent the safety zones"
"0","school_buffer <- schools %>%"
"0","  st_buffer (dist = 1000) %>%"
"0","  st_union() %>%"
"0","  st_as_sf()"
"0",""
"0","# Determine crimes within buffers/safety zones"
"0","crime_near_school <- st_join("
"0","  crime, school_buffer,"
"0","  join = st_within, left = FALSE"
"0",")"
"0",""
"0","# Count total crimes and the number that happened near schools"
"0","crime_total <- nrow(crime)"
"0","crime_schoolzone <- nrow(crime_near_school)"
"0",""
"0","# Find percent of crimes near schools"
"0","crime_percent <- round((crime_schoolzone / crime_total) *100, 2)"
"0",""
"0","# Results"
"0","cat(""Total Crimes:"", crime_total, ""\n"")"
"1","Total Crimes:"
"1"," "
"1","151197"
"1"," "
"1","
"
"0","cat(""Crimes within 1000ft of schools:"", crime_schoolzone, ""\n"")"
"1","Crimes within 1000ft of schools:"
"1"," "
"1","74198"
"1"," "
"1","
"
"0","cat(""Percent of crimes within 1000ft of schools:"", crime_percent, ""%\n"")"
"1","Percent of crimes within 1000ft of schools:"
"1"," "
"1","49.07"
"1"," "
"1","%
"
"0","# Map"
"0","ggplot() +"
"0","  geom_sf(data = crime,"
"0","          color = ""tomato"","
"0","          size = .5,"
"0","          alpha = .1) +"
"0","   geom_sf(data = school_buffer,"
"0","          fill = ""navyblue"","
"0","          alpha = .8) +"
"0","  geom_sf(data = schools,"
"0","          color = ""deepskyblue3"","
"0","          size = 1) +"
"0","  labs("
"0","    title = ""School Safety Zones and Crime in Philadelphia, PA"","
"0","    subtitle = ""1000ft Safety Buffer Around Schools and Locations of Crime"","
"0","    caption = ""Source: OpenDataPhilly"") +"
"0","  theme_void()"
"0",""
